<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!--<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">-->
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=0.5, maximum-scale=2.0" />
    <title>四合院社区综合管理平台</title>
    <meta name="renderer" content="webkit">
    <script src="scripts/js/jquery-1.11.3.min.js"></script>
    <!-- echarts -->
    <script src="scripts/js/echarts.js"></script>
    <script src="scripts/js/jquery.cookie.js"></script>
    <link rel="shortcut icon" href="assets/ico/logo.png">
    <!--<link href="scripts/themes/css/bootstrap.min.css" rel="stylesheet">-->
    <style type="text/css">
        html, body { height: 100%; /*overflow: hidden; */}
        body {
            font-family:"微软雅黑";
            background: url(images/Bitmap.png) no-repeat center center fixed;
            background-size: cover;
            /*min-height: 560px;*/
            overflow-y: auto;
            position: relative;
            color:#fff;
            margin: 0;
            padding: 0;
        }

        /*百分比进度条*/
        .divPercentBg{ width: 100%; height: 20px; border: #3EADF7 1px solid; background:rgba(39,73,119,0.43); border-radius: 10px; padding: 2px;  box-sizing:border-box; margin-top: 10px;}
        .divPercentBg .divPercentPlan{ width: 0%; height: 100%; border-radius: 8px; position: relative;
            background:#03F0FF;  /*不兼容渐变的浏览器*/
            /* Firefox 3.6+ */
            background: -moz-linear-gradient(left, #03F0FF, #41A8F6);
            /* Safari 5.1+, Chrome 10+ */
            background: -webkit-linear-gradient(left, #03F0FF, #41A8F6);
            /* Opera 11.10+ */
            background: -o-linear-gradient(left, #03F0FF, #41A8F6);
        }
        .divPercentBg .divPercentPlan .divPercentNum{ position: absolute; right: -46px; top:-2px; font-size: 14px;}

        .divPlanAccept .divPercentPlan{
            background:#F3BC76;  /*不兼容渐变的浏览器*/
            /* Firefox 3.6+ */
            background: -moz-linear-gradient(left, #F3BC76, #F19C2F);
            /* Safari 5.1+, Chrome 10+ */
            background: -webkit-linear-gradient(left, #F3BC76, #F19C2F);
            /* Opera 11.10+ */
            background: -o-linear-gradient(left, #F3BC76, #F19C2F);
        }
        .divPlanWait .divPercentPlan{
            background:#EB7C75;  /*不兼容渐变的浏览器*/
            /* Firefox 3.6+ */
            background: -moz-linear-gradient(left, #EB7C75, #F36666);
            /* Safari 5.1+, Chrome 10+ */
            background: -webkit-linear-gradient(left, #EB7C75, #F36666);
            /* Opera 11.10+ */
            background: -o-linear-gradient(left, #EB7C75, #F36666);
        }

        .divWebTitle{ text-align: center; position:absolute; top:0; left:0; width: 100%; background: url(images/backTitle.png) no-repeat center bottom 0px; z-index: 2;}
        .divWebTitle .spanTitle{ color: #fff; font-size: 38px; line-height: 2;}
        .divWebTitle .divWebTime{ position: absolute; top:50%; right: 30px; margin-top: -8px; font-size: 22px; color: #40A9F6;}

        .divWebMain{ position:absolute; top:0; left:0; width: 100%; height: 100%; padding:1.5%; padding-top: 90px; box-sizing: border-box;}
        .divWebMain .divWebMainTitle{color:rgba(255,255,255,0.84); font-size: 16px;}

        .divWebMain .divWebTop{ overflow: hidden; width: 100%; height:65%; padding-bottom: 1.5%; box-sizing: border-box;}

        .divWebMain .divWebTop .divWebTopLeft{ float:left; width:24%; height: 100%; background:rgba(3,34,79,0.45); font-size: 16px; padding: 10px; box-sizing: border-box;}
        .divWebMain .divWebTop .divWebTopLeft .divOnlinePercent{padding-top: 8%;}
        /*费用缴纳*/
        .divWebMain .divWebTop .divWebTopLeft .amountDetail{ overflow: hidden; padding:6% 0;}
        .divWebMain .divWebTop .divWebTopLeft .amountDetail .divDetaileCount{ float: left; width: 35%; padding: 0 1%; box-sizing: border-box;}
        .divWebMain .divWebTop .divWebTopLeft .amountDetail .divDetaileUnpaid{float: left; width: 35%;padding: 0 1%; box-sizing: border-box;}
        .divWebMain .divWebTop .divWebTopLeft .amountDetail .divDetaileHouses{float: left; width: 30%;padding: 0 1%; box-sizing: border-box;}
        .divWebMain .divWebTop .divWebTopLeft .amountDetail span{ display: block; text-align: center;  color: rgba(255,255,255,0.73);}
        .divWebMain .divWebTop .divWebTopLeft .amountDetail #detaileCount,.divWebMain .divWebTop .divWebTopLeft .amountDetail #detaileUnpaid,.divWebMain .divWebTop .divWebTopLeft .amountDetail #detaileHouses{ font-size: 24px; color: rgba(100,230,226,1);}
        /*今日新增报修单*/
        .divWebMain .divWebTop .divWebTopContent{ float:left; width:52%; height: 100%; padding: 0 1%; box-sizing: border-box;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentRight{ float: right; width: 56%; padding-right: 40px; box-sizing: border-box;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentRight .divWebMainTitle{ margin: 10px;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentRight .divPercent{ margin: 5.5% 0;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentRight .divPercent .divPercentCount{ float: right; font-size: 16px;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentRight .divPercent .divPercentTitle{font-size: 16px; color: #4FBCDA;}
        /*报修实时统计*/
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentLeft{ width: 44%;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentLeft .divWebMainTitle{ margin: 10px;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentLeft .divRepairsCount{ text-align: center;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentLeft .divRepairsCount .divRepairsNum{ display: inline-block; width: 60%;background: rgba(3,34,79,0.45); margin-bottom: 4px; padding: 1.5% 0; box-sizing: border-box;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentLeft .divRepairsCount .divRepairsNum span{ display:block; font-size: 16px; color: rgba(255,255,255,0.73); }
        .divRepairsCount .divRepairsNum #newRepairsNum,.divRepairsCount .divRepairsNum #disposeRepairsNum,.divRepairsCount .divRepairsNum #undisposedRepairsNum{ font-size: 38px; line-height:1.5;}
        .divRepairsCount .divRepairsNum #newRepairsNum{ color: #CF4A32;}
        .divRepairsCount .divRepairsNum #disposeRepairsNum{ color: #569243;}
        .divRepairsCount .divRepairsNum #undisposedRepairsNum{color: #F19C2F;}
        /*设施巡检实时统计*/
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentDown{ width: 100%; position: relative; padding-top: 20px; box-sizing: border-box;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentDown .divWebMainTitle{  position: absolute; left: 10px; top: 10px;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentDown .divPollingNum{float: right; width: 56%; padding-right: 2%; box-sizing: border-box; overflow: hidden;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentDown .divPollingNum .divPollingBox{ float: left; width: 33.33%; text-align: center; margin-bottom: 3%;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentDown .divPollingNum .divPollingBox span{ display: block; font-size: 16px;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentDown .divPollingNum .divPollingBox .number{ display: inline-block; margin-top: 10px; padding:3px; min-width: 80px; box-sizing: border-box; background: #0F90AF; border-radius: 3px; color: #fff; font-size: 38px;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentDown .divPollingNum .divPollingBox .numberRed{background: #962826;}
        .divWebMain .divWebTop .divWebTopContent .divWebTopContentDown .divPollingChart{ width: 44%; margin-top: 4%;}
        /*任务数量实时统计*/
        .divWebMain .divWebTop .divWebTopRight{ float:left; width:24%; height: 100%;  background:rgba(3,34,79,0.45);}
        .divWebMain .divWebTop .divWebTopRight .divTaskBrokenline{ width:100%; height: 60%; padding-top: 35px; box-sizing: border-box; position:relative;}
        .divWebMain .divWebTop .divWebTopRight .divTaskPercent{ width:100%; height: 40%; padding-top: 35px; box-sizing: border-box; position:relative;}
        .divWebMain .divWebTop .divWebTopRight .divWebMainTitle{ position: absolute; left: 10px; top: 10px;}
        /**/
        .divWebMain .divWebDown{ overflow: hidden; width: 100%; height:35%;}
        /*社区房屋状态*/
        .divWebMain .divWebDown .divWebHouse{ float:left; width:34%; height: 100%; background:rgba(3,34,79,0.45); padding-top: 35px; box-sizing: border-box; position:relative; overflow: hidden;}
        .divWebMain .divWebDown .divWebHouse .divWebMainTitle{  position: absolute; left: 10px; top: 10px;}
        .divWebMain .divWebDown .divWebHouse .divHousePillar,.divWebMain .divWebDown .divWebHouse .divHousePercent{ float: left;  width:50%; height: 100%;}
        /*车位数量预览*/
        .divWebMain .divWebDown .divWebCars{ float:left; width:24%; height: 100%;  background:rgba(3,34,79,0.45); margin: 0 0.5%; box-sizing: border-box; }
        .divWebMain .divWebDown .divWebCars .divWebMainTitle{ margin-top: 10px; margin-left: 10px;}
        .divWebMain .divWebDown .divWebCars .divWebCarsMain{ text-align: center; margin: 4% 0;}
        .divWebMain .divWebDown .divWebCars .divWebCarsCircle{ display: inline-block; width: 26%; height:6.05vw; background:rgba(86,146,67,0.57); border-radius: 50%; margin: 0 2%;  box-sizing: border-box; padding: 7px;}
        .divWebMain .divWebDown .divWebCars .divCarsCircle{ display: table; width: 100%; height: 100%; border-radius: 50%; background: #569243;;}
        .divWebMain .divWebDown .divWebCars .divCarsCircle .divCarsDiv{ display: table-cell; vertical-align: middle;}
        .divWebMain .divWebDown .divWebCars .divCarsCircle span{ display: block; font-size: 13px;}
        .divWebMain .divCarsCircle #undergroundNum,.divWebMain .divCarsCircle #groundNum,.divWebMain .divCarsCircle #temporaryNum{ font-size:28px; line-height: 1.2;}
        .divWebMain .divWebDown .divWebCars .divWebCarport{ width: 90%; margin: 0 5%; font-size: 14px; padding-left: 20px; box-sizing: border-box;}
        .divWebMain .divWebDown .divWebCars .divWebCarport .divCarport{ position: relative; padding: 0 70px 0 110px; box-sizing: border-box; margin-bottom: 2%;}
        .divWebMain .divWebDown .divWebCars .divWebCarport .divCarport .spanTitle{ display: block; width: 100px; position: absolute; left: 0; text-align: right;}
        .divWebMain .divWebDown .divWebCars .divWebCarport .divCarport .spanCarsNum{display: block; width: 60px;  position: absolute; right: 0;}
        .divWebMain .divWebDown .divWebCars .divWebCarport .divPercentBg{border:0; background: none; margin: 0; padding:5px 0;}
        .divWebMain .divWebDown .divWebCars .divWebCarport .divPercentBg .divPercentPlan{ height: 10px;}

        .divWebMain .divWebDown .divWebCars .divWebCarsCircleRed{background:rgba(207,74,50,0.57);}
        .divWebMain .divWebDown .divWebCars .divWebCarsCircleRed .divCarsCircle{background: #A13E33;}

        /*各部门完成任务情况实时统计*/
        .divWebMain .divWebDown .divWebDepartment{ float:left; width:41%; height: 100%; background:rgba(3,34,79,0.45);  overflow: hidden;}
        .divWebMain .divWebDown .divDepartmentPillar{ float: left; width: 50%; height: 100%; padding-top: 35px; box-sizing: border-box; position:relative;}
        .divWebMain .divWebDown .divDepartmentRanking{ float: left; width: 50%; height: 100%; padding-top:50px; box-sizing: border-box; position:relative;}
        .divWebMain .divWebDown .divWebDepartment .divWebMainTitle{  position: absolute; left: 10px; top: 10px;}
        .divWebMain .divWebDown .divDepartmentRanking .divCarport{ position: relative; padding: 0 70px 0 110px; box-sizing: border-box; margin-bottom:5%; font-size: 14px;}
        .divWebMain .divWebDown .divDepartmentRanking .divCarport .spanTitle{ display: block; width: 100px; position: absolute; left: 0; text-align: right; padding-left: 30px; box-sizing: border-box;}
        .divWebMain .divWebDown .divDepartmentRanking .divCarport .spanTitle .spanIcon{ display: none; position: absolute; left: 6px; top: 1px; width: 18px; height: 18px; text-align: center; line-height: 18px; font-size: 12px; background: #A92E2A; color: #fff;}
        .divWebMain .divWebDown .divDepartmentRanking .divCarport:nth-child(1) .spanTitle .spanIcon{display: block; background: #A92E2A;}
        .divWebMain .divWebDown .divDepartmentRanking .divCarport:nth-child(2) .spanTitle .spanIcon{display: block;  background: #D88F3B;}
        .divWebMain .divWebDown .divDepartmentRanking .divCarport:nth-child(3) .spanTitle .spanIcon{display: block;  background: #00C4F0;}

        .divWebMain .divWebDown .divDepartmentRanking .divCarport .spanCarsNum{display: block; width: 60px;  position: absolute; right: 0;}
        .divWebMain .divWebDown .divDepartmentRanking .divPercentBg{border:0; background: none; margin: 0; padding:5px 0;}
        .divWebMain .divWebDown .divDepartmentRanking .divPercentBg .divPercentPlan{ height: 10px;}
        /*.alarmDialog{  background: linear-gradient(to bottom right, #E4E3E2 , #fff);border:5px solid #B1B3B6;padding: 20px;overflow:visible; border-radius:20px;display:none;width: 46%;height: 50%;position: fixed;top:50%;left:50%;transform: translate(-50%,-50%);z-index: 99999}*/
        .alarmDialog{  background: #fff;border:5px solid #B1B3B6;padding: 20px;overflow:visible; border-radius:20px;display:none;width: 46%;height: 50%;position: fixed;top:50%;left:50%;transform: translate(-50%,-50%);z-index: 99999}
        .maskShadow{display:none;position: fixed;top:0;left:0;width: 100%;height:100%;background-color: rgba(0,0,0,0.5);z-index: 8888}
        .twinkleYellow{ box-sizing:border-box;
            -webkit-box-shadow:inset 0 0 450px -50px #f7970b;
            -moz-box-shadow:inset 0 0 450px -50px #f7970b;
            box-shadow:inset 0 0 450px -50px #f7970b;
            animation:borderblingYellow 1s infinite;
            -webkit-animation:borderblingYellow 1s infinite; /* Safari and Chrome */
        }

        @keyframes borderblingYellow
        {
            0% {
                -webkit-box-shadow:inset 0 0 450px -50px #f7970b;
                -moz-box-shadow:inset 0 0 450px -50px #f7970b;
                box-shadow:inset 0 0 450px -50px #f7970b;
            }
            50% {
                -webkit-box-shadow:inset 0 0 0px #f7970b;
                -moz-box-shadow:inset 0 0 0px #f7970b;
                box-shadow:inset 0 0 0px #f7970b;
            }
            100% {
                -webkit-box-shadow:inset 0 0 450px -50px #f7970b;
                -moz-box-shadow:inset 0 0 450px -50px #f7970b;
                box-shadow:inset 0 0 450px -50px #f7970b;
            }
        }

        @-webkit-keyframes borderblingYellow /* Safari and Chrome */
        {
            0% {
                -webkit-box-shadow:inset 0 0 450px -50px #f7970b;
                -moz-box-shadow:inset 0 0 450px -50px #f7970b;
                box-shadow:inset 0 0 450px -50px #f7970b;
            }
            50% {
                -webkit-box-shadow:inset 0 0 0px #f7970b;
                -moz-box-shadow:inset 0 0 0px #f7970b;
                box-shadow:inset 0 0 0px #f7970b;
            }
            100% {
                -webkit-box-shadow:inset 0 0 450px -50px #f7970b;
                -moz-box-shadow:inset 0 0 450px -50px #f7970b;
                box-shadow:inset 0 0 450px -50px #f7970b;
            }
        }


        .twinkle{ box-sizing:border-box;
            -webkit-box-shadow:inset 0 0 450px -50px #E63636;
            -moz-box-shadow:inset 0 0 450px -50px #E63636;
            box-shadow:inset 0 0 450px -50px #E63636;
            animation:borderbling 1s infinite;
            -webkit-animation:borderbling 1s infinite; /* Safari and Chrome */
        }

        @keyframes borderbling
        {
            0% {
                -webkit-box-shadow:inset 0 0 450px -50px #E63636;
                -moz-box-shadow:inset 0 0 450px -50px #E63636;
                box-shadow:inset 0 0 450px -50px #E63636;
            }
            50% {
                -webkit-box-shadow:inset 0 0 0px #E63636;
                -moz-box-shadow:inset 0 0 0px #E63636;
                box-shadow:inset 0 0 0px #E63636;
            }
            100% {
                -webkit-box-shadow:inset 0 0 450px -50px #E63636;
                -moz-box-shadow:inset 0 0 450px -50px #E63636;
                box-shadow:inset 0 0 450px -50px #E63636;
            }
        }

        @-webkit-keyframes borderbling /* Safari and Chrome */
        {
            0% {
                -webkit-box-shadow:inset 0 0 450px -50px #E63636;
                -moz-box-shadow:inset 0 0 450px -50px #E63636;
                box-shadow:inset 0 0 450px -50px #E63636;
            }
            50% {
                -webkit-box-shadow:inset 0 0 0px #E63636;
                -moz-box-shadow:inset 0 0 0px #E63636;
                box-shadow:inset 0 0 0px #E63636;
            }
            100% {
                -webkit-box-shadow:inset 0 0 450px -50px #E63636;
                -moz-box-shadow:inset 0 0 450px -50px #E63636;
                box-shadow:inset 0 0 450px -50px #E63636;
            }
        }
        .alarmTitle{width: 100%;margin: 0 auto;text-align: center;position: relative}
        .alarmTitle_pic{width: 15%;display: inline-block;margin: 0 auto}
        .alarmTitle_des{margin:5px;width: 100%;display: block;text-align: center;font-weight: bold;font-family: PingFangSC-Semibold; font-size: 23px;  color: #E63636;}
        .alarmTitle div{position: absolute;right:20px;bottom:10px;font-size: 18px}
        .firstLevel{color: #E63636;margin:0;margin-bottom: 5px}
        .secondLevel{color: #f7970b;margin:0;}
        .alarmList{overflow-y:auto;list-style: none;width: 90%;height:65%;margin:0 auto;margin-top: 20px;font-family: PingFangSC-Regular;font-size: 18px;  color: #444444;padding: 0 15px}
        .alarmList li{border-radius:7px;background-color: #fff; margin:20px 0;margin-top:1px;overflow:hidden;height: 25%;box-shadow: 0 0 12px 0 rgba(0,0,0,0.07);display: flex;justify-content: center;  align-items: center; color: #444444;font-size: 20px}
        .alarmList li div{text-align:left;}
        .liIndex{margin-left:5px;flex: 0.5;opacity: 0.28;  font-family: PingFangSC-Regular;font-size: 36px!important;color: #FF5F5F!important;}
        .alarmContent{flex:3;color: #333!important;font-weight: bold;font-size: 22px!important;}
        .alarmHouse{flex: 2}
        .connectdetail{flex: 3.5}
        .okBtn{background: #E63636;box-shadow: 0 0 10px 0 rgba(238,88,69,0.58); border-radius: 37px;width: 200px;height: 60px;position: absolute;bottom: 0;left: 50%;
            margin-left:-105px;margin-bottom: -30px;color: #fff;text-align: center ;line-height: 60px;cursor: pointer;font-size: 23px!important;}
        .okBtn_yellow{background: #f7970b!important;box-shadow: 0 0 10px 0 rgba(247,157,11,0.58)!important; }
        .firstLevelColor{color:#E63636!important;}
        .secondLevelColor{color:#f7970b!important;}
        /* 设置滚动条的样式 */
        ::-webkit-scrollbar {
            width: 12px;
        }
        /* 滚动槽 */
        ::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
            border-radius: 10px;
        }
        /* 滚动条滑块 */
        ::-webkit-scrollbar-thumb {
            border-radius: 10px;
            background: rgba(0,0,0,0.1);
            -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5);
        }
        ::-webkit-scrollbar-thumb:window-inactive {
            background: rgba(255,0,0,0.4);
        }
        ::-webkit-scrollbar-button {
            display: none !important;
        }
        #levelOneCount,#levelTwoCount{
            display: inline-block;
            width:40px;
            vertical-align: bottom;
            text-shadow:1px 1px 2px #555;
            /*font-weight: bold;*/
        }
    </style>
    <script src="scripts/js/common/common.js"></script>
    <script>
        var index=1;
        var levelOneCount=0;
        var levelTwoCount=0;
        var highestLevel=2;
        var dpr = window.devicePixelRatio || 1, scale = 1 / dpr;
        console.log(scale)
        var metaEl = document.querySelector('meta[name="viewport"]');
        metaEl.setAttribute('content', 'width=device-width,initial-scale='+scale+',maximum-scale='+scale+',minimum-scale='+ scale+',user-scalable=no');
        //智能家居实时告警
        if ("WebSocket" in window)
        {
            var pathAllView = window.location.href;
            var pathPortLengthView = window.location.port.length;
            var pathIndexView = pathAllView.indexOf(window.location.port);
            var pathExView = pathAllView.slice(0, pathIndexView );
            if(pathExView.lastIndexOf(':')!=5&&pathExView.lastIndexOf(':')!=4){
                var pathWss = pathExView.replace('https','wss').replace('http','wss')  + '8100/websocketDemo/66';
            }else{
                var pathWss = pathExView.replace('https','wss').replace('http','wss')  + ':8100/websocketDemo/66';
            }
            var ws = new WebSocket(pathWss);

            ws.onopen = function()
            {
                ws.send("发送数据");
                console.log('ws连接中')
            };
            var alarmIndex=1;
            ws.onmessage = function (evt)
            {
                var received_msg = evt.data;
                $('#alarmDialog').fadeIn();
                $('.maskShadow').show();
                $('.maskShadow').addClass('twinkleYellow');
                $('#alarmSound').attr('src','http://192.168.199.188:13333/upload/alarm.mp3');
                audio.play();
                $('#triggerBtn').click();
                var msgObj=JSON.parse(received_msg);
                for(var i=0;i<msgObj.length;i++){
                    var alarmType;
                    if(msgObj[i].flag==1){
                        alarmType="燃气检测异常！"
                    }
                    if(msgObj[i].flag==2){
                        alarmType="烟雾检测异常！"
                    }
                    if(msgObj[i].flag==3){
                        alarmType="水浸检测异常！"
                    }
                    if(msgObj[i].flag==4){
                        alarmType="门磁检测异常！"
                    }
                    if(msgObj[i].level==1&&levelOneCount<=1000){
                        var levelClass= "firstLevelColor";
                        levelOneCount++;
                        if (levelOneCount>1000){
                            levelOneCount="1000+";
                        }
                        $('#levelOneCount').stop(true).animate({
                            'font-size':'30px',
                            'font-weight':'bold',
                        },'slow',function () {
                            $('#levelOneNum').html(levelOneCount);
                        }).animate({
                            'font-size':'18px',
                            'font-weight':'nomal',
                        },'slow');
                    }
                    if(msgObj[i].level==2&&levelTwoCount<=1000){
                        var levelClass= "secondLevelColor";
                        levelTwoCount++;
                        if (levelTwoCount>1000){
                            levelTwoCount="1000+";
                        }
                        $('#levelTwoCount').stop(true).animate({
                            'font-size':'30px',
                            'font-weight':'bold',
                        },'slow',function () {
                            $('#levelTwoNum').html(levelTwoCount);
                        }).animate({
                            'font-size':'18px',
                            'font-weight':'nomal',
                        },'slow');
                    }
                    var liLevel='liSecond';
                    if(msgObj[i].level==1){
                        highestLevel=1;
                        liLevel='liFirst';
                        $('.alarmDialog img').attr('src','images/alarm1.gif');
                        $('.maskShadow').addClass('twinkle');
                        $('.okBtn').removeClass('okBtn_yellow');
                    }
                    var html=['<li class="'+liLevel+'">',
                        '            <div class="liIndex '+levelClass+'">'+''+'</div>',
                        '            <div class="alarmContent '+levelClass+'">'+alarmType+'</div>',
                        '            <div class="alarmHouse">'+msgObj[i].houseName+'</div>',
                        '            <div class="connectdetail">',
                        '                <span>业主联系方式：</span>',
                        '                <span class="contentNo">'+msgObj[i].phone+'</span>',
                        '            </div>',
                        '</li>'].join("");
//                    alarmIndex++;
                    if(msgObj[i].level==1){
                        if($('.alarmList .firstLevelColor').length!=0){
                            $('li.liFirst:last').after(html);
                        }else{
                            $('.alarmList').prepend(html);
                        }
                    }else{
                        $('.alarmList').append(html);
                    }
                }


                $('.alarmList li').each(function () {
                    var index=$(this).index();
                    $(this).find('.liIndex').text(index+1);
                })

            };

            ws.onclose = function()
            {
                console.log("连接已关闭...");
            };
        }

        else
        {
            alert("您的浏览器不支持websocket实时通讯功能!");
        }


    </script>
</head>
<body>
<div class="maskShadow"></div>
<div style="" class="alarmDialog" id="alarmDialog">
    <audio autoplay="autoplay" id="alarmSound" src="http://192.168.199.188:13333/upload/alarm.mp3"  loop="loop" ></audio>
    <div id="triggerBtn"></div>
    <div class="alarmTitle">
        <img src="images/alarmYellow.gif" alt="" class="alarmTitle_pic">
        <!--<div class="alarmTitle_des">一级警报!</div>-->
        <div>
            <p class="firstLevel">
                <span>一级警报数量：</span>
                <span id="levelOneCount" style="position: relative">
                    <span id="levelOneNum" style="position: absolute;bottom: 0;right: 0">0</span>
                </span>
            </p>
            <p class="secondLevel">
                <span>二级警报数量：</span>
                <span id="levelTwoCount" style="position: relative">
                    <span id="levelTwoNum" style="position: absolute;bottom: 0;right: 0">0</span>
                </span>
            </p>
        </div>
    </div>
    <ul class="alarmList alarmListScroll">
    </ul>
    <div class="okBtn okBtn_yellow">
        我知道了
    </div>

</div>
<!--[if lte IE 7]>

<div id="errorie"><div>您还在使用老掉牙的IE，请升级您的浏览器到 IE8以上版本 <a target="_blank" href="http://windows.microsoft.com/zh-cn/internet-explorer/ie-8-worldwide-languages">点击升级</a>&nbsp;&nbsp;强烈建议您更改换浏览器：<a href="http://down.tech.sina.com.cn/content/40975.html" target="_blank">谷歌 Chrome</a></div></div>
<![endif]-->

<div class="webContainer">
    <div class="divWebTitle">
        <div class="divWebTime"><span id="span_dateTime"></span></div>
        <span class="spanTitle">智能物业综合管理中心</span>
    </div>
    <div class="divWebMain">
        <div class="divWebTop">
            <!--费用缴纳-->
            <div class="divWebTopLeft">
                <div class="divWebMainTitle">截止<span id="todayTime">12月1日</span>费用缴纳金额与户数统计</div>
                <div class="amountDetail">
                    <div class="divDetaileCount">
                        <span>应收总金额(元)</span>
                        <span id="detaileCount">0</span>
                    </div>
                    <div class="divDetaileUnpaid">
                        <span>未缴总金额(元)</span>
                        <span id="detaileUnpaid">0</span>
                    </div>
                    <div class="divDetaileHouses">
                        <span>逾期户数(户)</span>
                        <span id="detaileHouses">0</span>
                    </div>
                </div>

                <div class="divAmount">
                    <div id="amount" style=" width: 100%; height: 200px;"></div>
                </div>

                <div class="divOnlinePercent">
                    <div id="onlinePercent" style=" width: 100%; height: 200px;"></div>
                </div>
            </div>
            <!--费用缴纳-->
            <!--报修、巡检-->
            <div class="divWebTopContent">
                <div  class="divWebTopContentRight">
                    <div class="divWebMainTitle">今日新增报修单</div>
                    <div class="divPlan">
                        <div class="divPercent" id="planFinish">
                            <span class="divPercentCount">0</span>
                            <span class="divPercentTitle">已完成</span>
                            <div class="divPercentBg"><div class="divPercentPlan"><span class="divPercentNum">0%</span></div></div>
                        </div>
                        <div class="divPercent" id="planAccept">
                            <span class="divPercentCount">0</span>
                            <span class="divPercentTitle">已接单</span>
                            <div class="divPercentBg divPlanAccept"><div class="divPercentPlan"><span class="divPercentNum">0%</span></div></div>
                        </div>
                        <div class="divPercent" id="planWait">
                            <span class="divPercentCount">0</span>
                            <span class="divPercentTitle">待维修</span>
                            <div class="divPercentBg divPlanWait"><div class="divPercentPlan"><span class="divPercentNum">0%</span></div></div>
                        </div>
                    </div>
                </div>

                 <div class="divWebTopContentLeft">
                     <div class="divWebMainTitle">报修实时统计</div>
                     <div class="divRepairsCount">
                         <div class="divRepairsNum">
                             <span>今日新增报修单</span>
                             <span id="newRepairsNum">0</span>
                         </div>
                         <div class="divRepairsNum">
                             <span>今日处理报修单</span>
                             <span id="disposeRepairsNum">0</span>
                         </div>
                         <div class="divRepairsNum">
                             <span>剩余未处理报修单</span>
                             <span id="undisposedRepairsNum">0</span>
                         </div>
                     </div>
                 </div>

                <div  class="divWebTopContentDown">
                    <div class="divWebMainTitle">设施巡检结果统计</div>

                    <div class="divPollingNum">
                        <div class="divPollingBox" id="needEquipment" style=" display: none;">
                            <span>今日需巡检设备</span>
                            <span class="number">0</span>
                        </div>
                        <div class="divPollingBox" id="waitEquipment" style=" display: none;">
                            <span>今日待巡检设备</span>
                            <span class="number">0</span>
                        </div>
                        <div class="divPollingBox" id="finishEquipment">
                            <span>今日完成巡检设备</span>
                            <span class="number">0</span>
                        </div>
                        <div class="divPollingBox" id="usualEquipment">
                            <span>巡检正常设备</span>
                            <span class="number">0</span>
                        </div>
                        <div class="divPollingBox" id="unUsualEquipment">
                            <span>巡检异常设备</span>
                            <span class="number">0</span>
                        </div>
                    </div>

                    <div class="divPollingChart">
                        <div id="divPolling" style=" width: 100%; height: 200px;"></div>
                    </div>
                </div>
            </div>
            <!--报修、巡检-->
            <!--任务-->
            <div class="divWebTopRight">
                <div class="divTaskBrokenline">
                    <div class="divWebMainTitle">任务数量实时统计</div>
                    <div id="taskBrokenline"  style=" width: 100%; height: 100%;"></div>
                </div>
                <div class="divTaskPercent">
                    <div class="divWebMainTitle">任务完成统计</div>
                    <div id="taskPercent"  style=" width: 100%; height: 100%;"></div>
                </div>
            </div>
            <!--任务-->
        </div>
        <div class="divWebDown">
            <!--社区房屋状态-->
            <div class="divWebHouse">
                <div class="divWebMainTitle">社区房屋状态</div>
                <div class="divHousePillar">
                    <div id="housePillar"  style=" width: 100%; height: 100%;"></div>
                </div>
                <div class="divHousePercent">
                    <div id="housePercent"  style=" width: 100%; height: 100%;"></div>
                </div>
            </div>
            <!--社区房屋状态-->
            <!--车位数量预览-->
            <div class="divWebCars">
                <div class="divWebMainTitle">车位数量预览</div>
                <div class="divWebCarsMain">
                    <div class="divWebCarsCircle">
                        <div class="divCarsCircle">
                            <div class="divCarsDiv">
                                <span>地下车库剩余</span>
                                <span id="undergroundNum">10</span>
                            </div>
                        </div>
                    </div>
                    <div class="divWebCarsCircle">
                        <div class="divCarsCircle">
                            <div class="divCarsDiv">
                                <span>地面车位剩余</span>
                                <span id="groundNum">110</span>
                            </div>
                        </div>
                    </div>
                    <div class="divWebCarsCircle divWebCarsCircleRed">
                        <div class="divCarsCircle">
                            <div class="divCarsDiv">
                                <span>临时车位数</span>
                                <span id="temporaryNum">0</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="divWebCarport">
                    <div class="divCarport">
                        <span class="spanTitle">地下车库车位数</span>
                        <span class="spanCarsNum" id="undergroundCarport">2000</span>
                        <div class="divPercentBg"><div class="divPercentPlan" style=" width:100%;"></div></div>
                    </div>
                    <div class="divCarport">
                        <span class="spanTitle">地上车位数</span>
                        <span class="spanCarsNum" id="groundCarport">1500</span>
                        <div class="divPercentBg"><div class="divPercentPlan" style=" width:70%;"></div></div>
                    </div>
                    <div class="divCarport">
                        <span class="spanTitle">临时车位数</span>
                        <span class="spanCarsNum" id="temporaryCarport">200</span>
                        <div class="divPercentBg"><div class="divPercentPlan" style=" width:40%;"></div></div>
                    </div>
                </div>
            </div>
            <!--车位数量预览-->
            <!--各部门的任务-->
            <div class="divWebDepartment">
                <div class="divDepartmentPillar">
                    <div class="divWebMainTitle">各部门完成任务情况实时统计</div>
                    <div id="departmentPillar"  style=" width: 100%; height: 100%;"></div>
                </div>
                <div class="divDepartmentRanking">
                    <div class="divWebMainTitle">各部门任务完成百分比</div>
                    <div class="" id="departmentRanking">
                        <!--<div class="divCarport">
                            <span class="spanTitle"><span class="spanIcon">1</span>经理部</span>
                            <span class="spanCarsNum">72%</span>
                            <div class="divPercentBg"><div class="divPercentPlan" style=" width:72%;"></div></div>
                        </div>-->

                    </div>
                </div>
            </div>
            <!--各部门的任务-->
        </div>
    </div>
</div>
</body>

<script type="text/javascript">
    var audio = document.getElementById('alarmSound');
    var alarmDialog = document.getElementById('alarmDialog');
//    $('html').one('touchstart',function(){
//        audio.play();
//    });
    $('#triggerBtn').on('click',function(){
        audio.play();
    });
    $('.okBtn').click(function () {
        $('#alarmDialog').hide();
        $('.maskShadow').hide();
        $('#alarmSound').attr('src','');
        levelTwoCount=0;levelOneCount=0;alarmIndex=1;
        $('.alarmList').empty();
        $('#levelOneNum').html(0);
        $('#levelTwoNum').html(0);

        highestLevel=2;
        liLevel='liSecond';
        $('.alarmDialog img').attr('src','images/alarmYellow.gif');
        $('.maskShadow').removeClass('twinkle').addClass('twinkleYellow');
        $('.okBtn').addClass('okBtn_yellow');
    })
    function CurentTime()
    {
        var show_day=new Array('星期日','星期一','星期二','星期三','星期四','星期五','星期六');
        var now = new Date();

        var year = now.getFullYear();       //年
        var month = now.getMonth() + 1;     //月
        var day = now.getDate();            //日

        var Dday=now.getDay();

        var hh = now.getHours();            //时
        var mm = now.getMinutes();          //分
        var ss = now.getSeconds();           //秒

        var week = show_day[Dday];     //星期几

        var clock = year + "年";

        if(month < 10)
            clock += "0";

        clock += month + "月";

        if(day < 10)
            clock += "0";

        clock += day + "日&nbsp;&nbsp;";

        if(hh < 10)
            clock += "0";

        clock += hh + ":";
        if (mm < 10) clock += '0';
        clock += mm + ":";

        if (ss < 10) clock += '0';
        clock += ss + "&nbsp;&nbsp;";

        clock += week;
        return(clock);
    }
    setInterval(function() {
        $("#span_dateTime").html(CurentTime());
    }, 1000);


    function today() {
        var now = new Date();
        var year = now.getFullYear();       //年
        var month = now.getMonth() + 1;     //月
        var day = now.getDate();            //日

        var clock = year + "年";
        clock += month + "月";
        clock += day + "日";
        return(clock);

    }
    $("#todayTime").html(today());

    loadDate();
    setInterval(function() {
        loadDate();
    }, 60000);

    /*加载页面*/
    function loadDate(){
        $.ajax({
        type: "POST",
        url: "screen/v1/findData",
        contentType: 'application/json;charset=UTF-8',
        dataType: 'json',
        cache: false,
        headers:{"estateId":$.cookie("estateId")},
        success: function (json) {
            var echartsData = json.data;

            //费用
            var amountData = echartsData.expenseData;
            $("#detaileCount").html(amountData.paidTotal);   //应收总金额
            $("#detaileUnpaid").html(amountData.unPaidTotal);   //未缴纳总金额
            $("#detaileHouses").html(amountData.overDueHouses);   //预期户数

            amountEcharts([amountData.paidPropertyHouses,amountData.paidSpaceHouses,amountData.paidPublicHouses,amountData.paidEnergyHouses],
                    [amountData.unPaidPropertyHouses,amountData.unPaidSpaceHouses,amountData.unPaidPublicHouses,amountData.unPaidEnergyHouses],
                    [amountData.allPaidProperty,amountData.allPaidSpace,amountData.allPaidPublic,amountData.allPaidEnergy],
                    [amountData.allUnPaidProperty,amountData.allUnPaidSpace,amountData.allUnPaidPublic,amountData.allUnPaidEnergy]);
            onlineEcharts(amountData.onlinePercentage);

            //报修
            var repairData = echartsData.repairData;
            $("#newRepairsNum").html(repairData.todayRepairs);   //今日新增报修单
            $("#disposeRepairsNum").html(repairData.todayWorkedRepairs);   //今日处理报修单
            $("#undisposedRepairsNum").html(repairData.allUntreatedRepairs);   //剩余未处理报修单

            $("#planFinish .divPercentCount").html(repairData.todayFinishRepairs);   //今日已完成
            $("#planFinish .divPercentBg .divPercentPlan").css("width",repairData.todayFinishPercentage+"%");
            $("#planFinish .divPercentBg .divPercentPlan .divPercentNum").html(repairData.todayFinishPercentage+"%");
            $("#planAccept .divPercentCount").html(repairData.todayAcceptRepairs);   //今日已接单
            $("#planAccept .divPercentBg .divPercentPlan").css("width",repairData.todayAcceptPercentage+"%");
            $("#planAccept .divPercentBg .divPercentPlan .divPercentNum").html(repairData.todayAcceptPercentage+"%");
            $("#planWait .divPercentCount").html(repairData.todayWaitRepairs);   //今日待维修
            $("#planWait .divPercentBg .divPercentPlan").css("width",repairData.todayWaitPercentage+"%");
            $("#planWait .divPercentBg .divPercentPlan .divPercentNum").html(repairData.todayWaitPercentage+"%");

            //设备巡检
            var patrolData = echartsData.patrolData;
            pollingResultEcharts(100-patrolData.todayAbnormalPercentage,patrolData.todayAbnormalPercentage);

            $("#finishEquipment .number").html(patrolData.todayFinishEquipments);   //今日完成巡检设备
            $("#usualEquipment .number").html(patrolData.todayNormalEquipments);   //今日巡检正常设备
            if(patrolData.todayAbnormalEquipments > 0){
                $("#unUsualEquipment .number").addClass("numberRed");
            }else{
                $("#unUsualEquipment .number").removeClass("numberRed");
            }
            $("#unUsualEquipment .number").html(patrolData.todayAbnormalEquipments);   //今日巡检异常设备

            //社区房屋状态
            houseEcharts(echartsData.houseData.fullHouses,echartsData.houseData.rentHouses,echartsData.houseData.emptyHouses,echartsData.houseData.fullPercentage,echartsData.houseData.rentPercentage);

            //任务
            var task = echartsData.taskData;
            var todayTask = [];
            var todayNewTask = [];
            var todayFinishTask = [];
            var todayUnFinishTask = [];
            if(task.todayTaskDatas.length > 0){
                $.each(task.todayTaskDatas,function (s,v) {
                    todayTask.push(v.unfinishTasks);
                    todayNewTask.push(v.todayTasks);
                    todayFinishTask.push(v.todayFinishTasks);
                    todayUnFinishTask.push(v.todayUnFinishTasks);
                });
            }
            taskEcharts(todayTask,todayNewTask,todayFinishTask,todayUnFinishTask);
            taskFinishEcharts(task.todayFinishPercentage);

            //部门
            var departmentName = [];
            var allTaskData = [];
            var finishTaskData = [];
            var unFinishTaskData = [];
            var depTaskDataSort = [];  //获取前6个部门
            if(task.depTaskData.length > 0){
                $.each(task.depTaskData,function (s,v) {
                    if(s<6){
                        departmentName.push(v.depName);
                        allTaskData.push(v.allTasks);
                        finishTaskData.push(v.finishTasks);
                        unFinishTaskData.push(v.unFinishTasks);

                        depTaskDataSort.push(v);
                    }
                });

                //task.depTaskData.sort(getSortFun('desc', 'finishPercentage'));
                depTaskDataSort.sort(getSortFun('desc', 'finishPercentage')); //获取前6个部门，根据完成任务的百分比降序排队
                var html = '';
                $("#departmentRanking").html('');
                //console.log(depTaskDataSort)
                //$.each(task.depTaskData,function (s,v) {
                $.each(depTaskDataSort,function (s,v) {
                    if(s<6) {
                        html += '<div class="divCarport">';
                        html += '<span class="spanTitle"><span class="spanIcon">' + (s + 1) + '</span>' + v.depName + '</span>';
                        html += '<span class="spanCarsNum">' + v.finishPercentage + '%</span>';
                        html += '<div class="divPercentBg"><div class="divPercentPlan" style=" width:' + v.finishPercentage + '%;"></div></div>';
                        html += '</div>';
                    }
                });
                $("#departmentRanking").html(html);
            }
            departmentEcharts(departmentName,allTaskData,finishTaskData,unFinishTaskData);

        },
        error: function (json) {
        }
    });

    }

    function amountEcharts(a,b,c,d) {  //a:各项已缴用户数组， b:各项未缴费用户数组， c:各项已缴费用数组  d:各项未缴费用数组
        //费用缴纳
        var amount = echarts.init(document.getElementById('amount'));
        var amount_option = {
            tooltip: {
                //trigger: 'item',
                trigger: 'axis',
                axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                    type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                }
                //formatter: "{a} <br/>{b}: {c} ({d}%)"
            },
            title: [ {
                subtext: '用户',
                subtextStyle: {
                    color: 'rgba(255,255,255,0.7)',
                    fontSize: 14
                },
                left: '15%',
                top: -10
            }, {
                subtext: '费用',
                subtextStyle: {
                    color: 'rgba(255,255,255,0.7)',
                    fontSize: 14
                },
                left: '73%',
                top: -10
            }],
            legend: {
                data: ['已缴', '未缴'],
                textStyle: {
                    color: 'rgba(255,255,255,0.7)'          // 图例文字颜色
                }
            },
            grid: [{
                show: false,
                left: '4%',
                top: 30,
                bottom: 0,
                containLabel: true,
                width: '50%'
            }, {
                show: false,
                left: '50.5%',
                top: 30,
                bottom: 0,
                width: '20%',
                tooltip:{
                    trigger:'none'    //触发类型
                }
            }, {
                show: false,
                right: '4%',
                top: 30,
                bottom: 0,
                containLabel: true,
                width: '53%'
            }],
            xAxis: [{
                splitNumber: 2,   //坐标轴的分割段数
                type: 'value',
                inverse: true,
                axisLine: {
                    show: false,
                },
                axisTick: {
                    show: false,
                },
                position: 'bottom',
                axisLabel: {
                    show: true,
                    textStyle: {
                        color: '#ccc',
                        fontSize: 12
                    }
                },
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: '#57617f',
                        width: 1,
                        type: 'solid'
                    }
                }
            }, {
                gridIndex: 1,
                show: false,
            }, {
                gridIndex: 2,
                splitNumber: 2,
                type: 'value',
                axisLine: {
                    show: false,
                },
                axisTick: {
                    show: false,
                },
                position: 'bottom',
                axisLabel: {
                    show: true,
                    textStyle: {
                        color: '#ccc',
                        fontSize: 12,
                    },
                },
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: '#57617f',
                        width: 1,
                        type: 'solid',
                    },
                },
            }, ],
            yAxis: [{
                type: 'category',
                inverse: true,
                position: 'right',
                axisLine: {
                    show: false,
                },
                axisTick: {
                    show: false
                },
                axisLabel: {
                    show: false,
                },
                data: ['物业费','停车费','公摊水电费','能耗费'],

            }, {
                gridIndex: 1,
                type: 'category',
                inverse: true,
                position: 'center',
                axisLine: {
                    show: false
                },
                axisTick: {
                    show: false
                },
                axisLabel: {
                    show: true
                },
                data: [ {
                    value: '物业费',   // 突出样式
                    textStyle: {
                        color: 'rgba(255,255,255,0.7)',
                        align:"center",
                        verticalAlign:'top',
                        height:20,
                        padding:[-10, 0, 0, 0]
                    }
                },{
                    value: '停车费',   // 突出样式
                    textStyle: {
                        color: 'rgba(255,255,255,0.7)',
                        align:"center",
                        verticalAlign:'top',
                        height:20,
                        padding:[-15, 0, 0, 0]
                    }
                } ,{
                    value: '公摊水电费',   // 突出样式
                    textStyle: {
                        color: 'rgba(255,255,255,0.7)',
                        align:"center",
                        verticalAlign:'top',
                        height:20,
                        padding:[-20, 0, 0, 0]
                    }
                },{
                    value: '能耗费',   // 突出样式
                    textStyle: {
                        color: 'rgba(255,255,255,0.7)',
                        align:"center",
                        verticalAlign:'top',
                        height:20,
                        padding:[-25, 0, 0, 0]
                    }
                }]
            }, {
                gridIndex: 2,
                type: 'category',
                inverse: true,
                position: 'left',
                axisLine: {
                    show: false
                },
                axisTick: {
                    show: false
                },
                axisLabel: {
                    show: false,
                },
                data: ['物业费','停车费','公摊水电费','能耗费'],
            }, ],
            series: [{
                name: '已缴',
                type: 'bar',
                itemStyle: {
                    normal: {
                        color: '#58D1EF'
                    }
                },
                data:a,   //['2500', '5700', '5600', '4000'],     // 已缴用户
            }, {
                name: '未缴',
                type: 'bar',
                itemStyle: {
                    normal: {
                        color: '#F36666'
                    }
                },
                data:b,  //['6666', '5700', '5600', '400'],   // 未缴用户
                barGap: '20%',   //柱间距离，负数可以重叠
                barCategoryGap: '40%'   //类目间距
            }, {
                name: '已缴',
                type: 'bar',
                itemStyle: {
                    normal: {
                        color: '#58D1EF'
                    }
                },
                xAxisIndex: 2,
                yAxisIndex: 2,
                data:c,  //['6000', '5700', '5600', '4000'],     // 已缴费用
            }, {
                name: '未缴',
                type: 'bar',
                itemStyle: {
                    normal: {
                        color: '#F36666'
                    }
                },
                xAxisIndex: 2,
                yAxisIndex: 2,
                data: d,  //['6000', '5700', '5600', '4000'],   //未缴费用
                barGap: '20%',   //柱间距离，负数可以重叠
                barCategoryGap: '40%'   //类目间距
            }]
        }
        amount.setOption(amount_option);
    }

    function onlineEcharts(a){   //a:线上百分比
        //线上线下缴费的比例
        var onlinePercent = echarts.init(document.getElementById('onlinePercent'));
        var onlinePercent_option = {
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b}: {d}%"
            },
            color:['#d88f3b', '#4953aa'],
            legend: {
                orient: 'vertical',
                x: 'left',
                //data:['线上缴费','线下缴费']
            },
            series: [
                {
                    name:'缴费途径',
                    type:'pie',
                    radius: ['35%', '55%'],
                    data:[
                        {value:a,
                            name:'线上缴费',
                            label: {
                                normal: {
                                    formatter: '{b|{b}}\n{d|{d}%}  ',
                                    rich: {
                                        b: {
                                            fontSize:16
                                        },
                                        d: {
                                            fontSize:14,
                                            lineHeight: 24
                                        }
                                    }
                                }
                            }
                        },
                        {value:100-a,
                            name:'线下缴费',
                            label: {
                                normal: {
                                    formatter: '{b|{b}}\n{d|{d}%}  ',
                                    rich: {
                                        b: {
                                            fontSize:16
                                        },
                                        d: {
                                            fontSize:14,
                                            lineHeight: 24
                                        }
                                    }
                                }
                            }
                        }
                    ]
                }
            ]
        };

        // 使用刚指定的配置项和数据显示图表。
        window.onresize = onlinePercent.resize;   //resize：在容器发生变化时，改变图标的尺寸
        $(".divWebMain").resize(onlinePercent.resize);
        onlinePercent.setOption(onlinePercent_option);
    }


    //浏览器大小改变时重置大小
    /*window.onresize = function () {
        myChartContainer();
        myChart.resize();
    };*/

    function pollingResultEcharts(e,f){  //e:正常设备的百分比   f：故障的百分比
        //设施巡检结果统计
        var divPolling = echarts.init(document.getElementById('divPolling'));
        var divPolling_option = {
            color:['#58d1ef','#0f90af'],
            title: {
                left: 'center',
                top: 0,
            },
            tooltip : {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {d}%"
            },
            series : [
                {
                    name:'设施巡检结果',
                    type:'pie',
                    radius : '50%',
                    center: ['50%', '50%'],
                    data:[
                        {value:e,
                            name:'正常',
                            selected:true,  //鼠标选中的效果
                            label: {
                                normal: {
                                    formatter: '{b|{b}}\n{d|{d}%}  ',
                                    rich: {
                                        b: {
                                            fontSize:16
                                        },
                                        d: {
                                            fontSize:14,
                                            lineHeight: 24
                                        }
                                    }
                                }
                            }
                        },
                        {value:f,
                            name:'故障',
                            label: {
                                normal: {
                                    formatter: '{b|{b}}\n{d|{d}%}  ',
                                    rich: {
                                        b: {
                                            fontSize:16
                                        },
                                        d: {
                                            fontSize:14,
                                            lineHeight: 24
                                        }
                                    }
                                }
                            }
                        },
                        /*{value:274,
                         name:'待巡检',
                         label: {
                         normal: {
                         formatter: '{b|{b}}\n{d|{d}%}  ',
                         rich: {
                         b: {
                         fontSize:16
                         },
                         d: {
                         fontSize:14,
                         lineHeight: 24
                         }
                         }
                         }
                         }
                         }*/
                    ],
                    animationType: 'scale',
                    animationEasing: 'elasticOut'

                }
            ]
        };
        divPolling.setOption(divPolling_option);
    }

    function taskEcharts(a,b,c,d){  //a:未完成 b:当天新增  c:当天完成 d:当天未完成
        //任务数量实时统计
        var taskBrokenline = echarts.init(document.getElementById('taskBrokenline'));
        var taskBrokenline_option = {
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data:['未完成','当天新增','当天完成','当天未完成'],
                textStyle: {
                    color: 'rgba(255,255,255,0.5)'          // 图例文字颜色
                }
            },
            grid: {
                left: '1%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: [
                    {
                        value: '0:00',   // 突出样式
                        textStyle: {
                            color: 'rgba(88,209,239,1)',
                            align:"center"
                        }
                    },{
                        value: '9:00',   // 突出样式
                        textStyle: {
                            color: 'rgba(88,209,239,1)',
                            align:"center"
                        }
                    },{
                        value: '12:00',   // 突出样式
                        textStyle: {
                            color: 'rgba(88,209,239,1)',
                            align:"center"
                        }
                    },{
                        value: '15:00',   // 突出样式
                        textStyle: {
                            color: 'rgba(88,209,239,1)',
                            align:"center"
                        }
                    },{
                        value: '18:00',   // 突出样式
                        textStyle: {
                            color: 'rgba(88,209,239,1)',
                            align:"center"
                        }
                    },{
                        value: '24:00',   // 突出样式
                        textStyle: {
                            color: 'rgba(88,209,239,1)',
                            align:"center"
                        }
                    }],
                axisLine: {
                    show: true,
                    lineStyle:{
                        color: 'rgba(255,255,255,0.3)',
                    }
                }
            },
            yAxis: {
                type: 'value',
                axisLabel:{
                    color: 'rgba(88,209,239,1)',
                    align:"right"
                },
                axisLine: {
                    show: true,
                    lineStyle:{
                        color: 'rgba(255,255,255,0.3)',
                    }
                },
                splitLine:{
                    lineStyle:{
                        color: 'rgba(255,255,255,0.3)',
                    }
                }
            },
            series: [
                {
                    name:'未完成',
                    type:'line',
                    data:a    //data:[120, 132, 101, 134, 90]
                },
                {
                    name:'当天新增',
                    type:'line',
                    data:b    //data:[220, 182, 191, 234, 290]
                },
                {
                    name:'当天完成',
                    type:'line',
                    data:c    //data:[150, 232, 201, 154, 190]
                },
                {
                    name:'当天未完成',
                    type:'line',
                    data:d    //data:[320, 332, 301, 334, 390]
                }
            ]
        };
        taskBrokenline.setOption(taskBrokenline_option);
    }

    function taskFinishEcharts(a) {  //a:任务已完成的百分比
        //任务完成统计
        var taskPercent = echarts.init(document.getElementById('taskPercent'));
        var taskPercent_option = {
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {d}%"
            },
            color:["rgba(105,240,204,1)","#274977"],
            legend: {
                orient: 'vertical',
                left: 'left',
                data: ['已完成'],
                textStyle: {
                    color: 'rgba(255,255,255,0.7)'          // 图例文字颜色
                }
            },
            series: [{
                name: '任务完成统计',
                type: 'pie',
                radius: ['50%', '70%'],
                label: {
                    normal: {
                        position: 'center',
                        padding:[40, 0, 0, 0]
                    }
                },
                data: [{
                    value: a,
                    name: '已完成',
                    label: {
                        normal: {
                            formatter: '{b}\n{d} %',
                            textStyle: {
                                fontSize: 20
                            }
                        }
                    }
                }, {
                    value:100-a,
                    name: '',   //未完成
                    label: {
                        normal: {
                            textStyle: {
                                fontSize: 20
                            }
                        }
                    },
                    tooltip: {
                        show: false
                    },
                    hoverAnimation: false
                }]
            }]
        };
        taskPercent.setOption(taskPercent_option);
    }

    function  houseEcharts(a,b,c,d,e) {   //a:自住，b:出租，c:空置  d:自住的百分比 e：出租的百分比  //100-e-f:空置的百分比
        //社区房屋状态--柱状图
        var housePillar = echarts.init(document.getElementById('housePillar'));
        var housePillar_option = {
            color: ['#0087C5','#9D474D','#4953AA'],
            tooltip : {
                trigger: 'axis',
                axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                    type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis : [
                {
                    type : 'category',
                    data : ['自住', '出租', '空置'],
                    axisTick: {
                        alignWithLabel: true
                    },
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: 'rgba(88,209,239,1)',
                            fontSize: 12
                        }
                    },
                    axisLine: {
                        show: true,
                        lineStyle:{
                            color: 'rgba(255,255,255,0.3)',
                        }
                    }
                }
            ],
            yAxis : [
                {
                    name:"房屋数量",
                    nameTextStyle:{
                        color:'rgba(88,209,239,1)'
                    },
                    type : 'value',
                    axisLabel: {
                        show: true,
                        textStyle: {
                            color: 'rgba(88,209,239,1)',
                            fontSize: 12
                        }
                    },
                    axisLine: {
                        show: true,
                        lineStyle:{
                            color: 'rgba(255,255,255,0.3)',
                        }
                    },
                    splitLine:{
                        lineStyle:{
                            color: 'rgba(255,255,255,0.3)',
                        }
                    }
                }
            ],
            series : [
                {
                    name:'房屋数量 ',
                    type:'bar',
                    barWidth: '40%',
                    //data:[390,250, 120],
                    data:[a,b,c],
                    markPoint:{
                        label: {
                            normal: {
                                show:true
                            }
                        },
                        data: [
                            /*{type : 'max', name: '最大值'},
                            {type : 'min', name: '最小值'},
                            {type : 'average', name: '平均值'},*/
                            //{coord: ["出租",b]}   //第一个是坐标，第二个是显示的值
                            {coord: ["自住",a]},
                            {coord: ["出租",b]},
                            {coord: ["空置",c]}
                        ]
                    }
                }

            ]
        };
        housePillar.setOption(housePillar_option);

        //社区房屋状态--饼状图
        var housePercent = echarts.init(document.getElementById('housePercent'));
        var housePercent_option = {
            color:["#0087C5","#4953AA","#9D474D"],
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b}: {d}%"
            },
            legend: {
                orient: 'vertical',
                left: 'right',
                data : ['自住', '出租', '空置'],
                textStyle: {
                    color: 'rgba(255,255,255,0.7)'          // 图例文字颜色
                }
            },
            series : [
                {
                    name: '房屋状态',
                    type: 'pie',
                    radius : '55%',
                    center: ['50%', '60%'],
                    data:[
                        /*{value:390, name:'自住'},
                        {value:250, name:'出租'},
                        {value:120, name:'空置'}*/
                        {value:d,
                            name:'自住',
                            label: {
                                normal: {
                                    formatter: '{b|{b}}\n{d|{d}%}  ',
                                    rich: {
                                        b: {
                                            fontSize:16
                                        },
                                        d: {
                                            fontSize:14,
                                            lineHeight: 24
                                        }
                                    }
                                }
                            }},
                        {value:e,
                            name:'出租',
                            label: {
                                normal: {
                                    formatter: '{b|{b}}\n{d|{d}%}  ',
                                    rich: {
                                        b: {
                                            fontSize:16
                                        },
                                        d: {
                                            fontSize:14,
                                            lineHeight: 24
                                        }
                                    }
                                }
                            }},
                        {value:100-d-e,
                            name:'空置',
                            label: {
                                normal: {
                                    formatter: '{b|{b}}\n{d|{d}%}  ',
                                    rich: {
                                        b: {
                                            fontSize:16
                                        },
                                        d: {
                                            fontSize:14,
                                            lineHeight: 24
                                        }
                                    }
                                }
                            }}
                    ],
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };
        housePercent.setOption(housePercent_option);
    }

    function departmentEcharts(n,a,b,c){  //n:部门名称 a:总数的数组   b：已完成的数组 c：未完成的数组
        //各部门完成任务情况实时统计
        var departmentPillar = echarts.init(document.getElementById('departmentPillar'));
        var departmentPillar_option = {
            legend: {
                data: ['总数', '已完成', '未完成'],
                align: 'right',
                right: 10,
                textStyle: {
                    color: 'rgba(255,255,255,0.7)'          // 图例文字颜色
                }
            },
            tooltip : {
                trigger: 'axis',
                axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                    type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: [{
                type: 'category',
                //data: ['经理部', '保洁部', '安保部', '冷暖部', '工程部','客服部'],
                data:n,
                boundaryGap:true,
                axisTick: {
                    alignWithLabel: true,
                    interval:0,   //设置成 0 强制显示所有标签
                    alignWithLabel:true   // 保证刻度线和标签对齐
                },
                axisLabel: {
                    show: true,
                    interval:0,  //设置成 0 强制显示所有标签
                     //rotate:40,   // 将文字倾斜
                    formatter:function(value)    //两个字的加\n的换行
                    {
                        var ret = "";//拼接加\n返回的类目项
                        var maxLength = 2;//每项显示文字个数
                        var valLength = value.length;//X轴类目项的文字个数
                        var rowN = Math.ceil(valLength / maxLength); //类目项需要换行的行数
                        if (rowN > 1)//如果类目项的文字大于3,
                        {
                            for (var i = 0; i < rowN; i++) {
                                var temp = "";//每次截取的字符串
                                var start = i * maxLength;//开始截取的位置
                                var end = start + maxLength;//结束截取的位置
                                //这里也可以加一个是否是最后一行的判断，但是不加也没有影响，那就不加吧
                                temp = value.substring(start, end) + "\n";
                                ret += temp; //凭借最终的字符串
                            }
                            return ret;
                        }
                        else {
                            return value;
                        }
                    },
                    textStyle: {
                        color: 'rgba(88,209,239,1)',
                        fontSize: 12
                    }
                },
                axisLine: {
                    show: true,
                    lineStyle:{
                        color: 'rgba(255,255,255,0.3)',
                    }
                }
            }],
            yAxis: [{
                type: 'value',
                name: '数量',
                nameTextStyle:{
                    color:'rgba(88,209,239,1)'
                },
                axisLabel: {
                    formatter: '{value}'
                },
                axisTick: {
                    alignWithLabel: true
                },
                axisLabel: {
                    show: true,
                    textStyle: {
                        color: 'rgba(88,209,239,1)',
                        fontSize: 12
                    }
                },
                axisLine: {
                    show: true,
                    lineStyle:{
                        color: 'rgba(255,255,255,0.3)',
                    }
                },
                splitLine:{
                    lineStyle:{
                        color: 'rgba(255,255,255,0.3)',
                    }
                }
            }],
            series: [{
                name: '总数',
                type: 'bar',
                //data: [20, 30, 31,22,40,60]
                data: a
            }, {
                name: '已完成',
                type: 'bar',
                //data: [10, 20, 5,10,25,12]
                data:b
            }, {
                name: '未完成',
                type: 'bar',
                //data: [15, 20, 15,10,5,30]
                data:c
            }]
        };
        departmentPillar.setOption(departmentPillar_option);
    }

    //数组排序的条件参数提取
    function getSortFun(order, sortBy) {
        var ordAlpah = (order == 'asc') ? '>' : '<';
        var sortFun = new Function('a', 'b', 'return a.' + sortBy + ordAlpah + 'b.' + sortBy + '?1:-1');
        return sortFun;
    }

</script>
</html>